# Технологический стек проекта

## Backend

### Telegram Bot
- **Runtime**: Bun (быстрая альтернатива Node.js)
- **Язык**: TypeScript
- **Библиотека для Telegram**: grammY
  - Современная, типобезопасная библиотека для Telegram Bot API
  - Поддержка middleware и композиции
  - Встроенная поддержка сессий

### API Server
- **Framework**: Express.js
- **Язык**: TypeScript
- **Runtime**: Bun
- **CORS**: Настроен для работы с React админкой

## Frontend (Админ-панель)

- **Framework**: React 18
- **Язык**: TypeScript
- **Bundler**: Vite (быстрая сборка и HMR)
- **Роутинг**: React Router v6
- **HTTP клиент**: Axios
- **Иконки**: Lucide React (современная альтернатива Feather Icons)
- **Стили**: Чистый CSS (без препроцессоров)

## База данных

- **СУБД**: PostgreSQL 15+
- **ORM**: Prisma
  - Типобезопасный клиент для TypeScript
  - Автогенерация типов
  - Миграции
  - Prisma Studio для визуального управления данными

## Инфраструктура

### Пакетный менеджер
- **Bun** - ультрабыстрый пакетный менеджер и runtime
  - В 2-10 раз быстрее npm/yarn
  - Встроенный bundler
  - Нативная поддержка TypeScript

### Workspaces
Проект использует Bun workspaces для монорепо:
- `bot/` - Telegram бот
- `admin/` - Админ-панель
- `shared/` - Общие ресурсы (Prisma схема)
- `shared/api/` - API сервер

## Архитектурные решения

### Почему Node.js + grammY для бота?

1. **grammY** - одна из самых современных библиотек для Telegram:
   - Полная типобезопасность
   - Отличная документация
   - Активное комьюнити
   - Middleware архитектура

2. **TypeScript** обеспечивает:
   - Типобезопасность на всех уровнях
   - Автодополнение в IDE
   - Раннее обнаружение ошибок
   - Лучшую поддержку

3. **Альтернативы (не выбраны)**:
   - Python + aiogram: медленнее, меньше типобезопасности
   - Rust: излишняя сложность для бота
   - Go: меньше экосистемы для Telegram

### Почему React для админки?

1. **Широкое распространение** - легко найти разработчиков
2. **Богатая экосистема** библиотек
3. **Vite** для мгновенной разработки
4. **TypeScript** для надёжности

### Почему Prisma?

1. **Типобезопасность** - автогенерация типов из схемы
2. **Миграции** - версионирование изменений БД
3. **Prisma Studio** - удобный GUI для работы с данными
4. **Отличный DX** (Developer Experience)

### Почему PostgreSQL?

1. **Надёжность** - проверенная временем СУБД
2. **JSONB** поддержка для гибких данных (introduction_data)
3. **Полнотекстовый поиск** (для будущих функций)
4. **Транзакции** и ACID гарантии

## Производительность

### Bun vs Node.js
- Установка пакетов: **~10x быстрее**
- Запуск TypeScript: **~3x быстрее**
- HTTP сервер: **~2x быстрее**

### Vite vs Webpack
- Холодный старт: **~10x быстрее**
- HMR (Hot Module Replacement): **мгновенный**

## Безопасность

### Текущие меры
- Параметризованные запросы (Prisma защищает от SQL инъекций)
- CORS настроен только для локального хоста
- Нет хранения чувствительных данных в коде (.env файлы)

### Рекомендации для продакшена
- [ ] Добавить JWT аутентификацию для админки
- [ ] Настроить HTTPS
- [ ] Добавить rate limiting
- [ ] Шифрование паролей пользователей (bcrypt)
- [ ] Валидация входных данных (zod)
- [ ] Логирование действий админов

## Масштабирование

### Текущая архитектура
Подходит для:
- До 10,000 активных пользователей
- До 100 запросов в секунду

### Для роста нужно:
1. **Redis** для кэширования и сессий
2. **Message Queue** (Bull/BullMQ) для фоновых задач
3. **Горизонтальное масштабирование** бота (несколько инстансов)
4. **CDN** для статики админки
5. **Connection pooling** для БД

## Мониторинг и логирование

### Рекомендуется добавить:
- **Winston** или **Pino** для структурированных логов
- **Sentry** для отслеживания ошибок
- **PM2** для управления процессами
- **Prometheus + Grafana** для метрик

## Тестирование

### Рекомендуемый стек:
- **Vitest** для unit тестов (быстрее Jest)
- **Playwright** для E2E тестов админки
- **grammY тесты** для обработчиков бота

## CI/CD

### Рекомендуемый pipeline:
1. **GitHub Actions** для автоматизации
2. **Docker** для контейнеризации
3. **Docker Compose** для локальной разработки
4. **Vercel/Netlify** для деплоя админки
5. **VPS/Cloud** для бота и API

## Лицензии зависимостей

Все используемые библиотеки имеют MIT или Apache 2.0 лицензии.

